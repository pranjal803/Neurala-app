"use strict";angular.module("clientApp",["ngRoute"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main",data:{accessType:"PUBLIC"}}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login",data:{accessType:"NOT_LOGIN"}}).when("/register",{templateUrl:"views/register.html",controller:"RegisterCtrl",controllerAs:"register",data:{accessType:"NOT_LOGIN"}}).when("/profile",{templateUrl:"views/profile.html",controller:"ProfileCtrl",controllerAs:"profile",data:{accessType:"LOGIN"}}).when("/products",{templateUrl:"views/products.html",controller:"ProductsCtrl",controllerAs:"products",data:{accessType:"LOGIN"}}).when("/error",{templateUrl:"views/error.html",data:{accessType:"PUBLIC"}}).otherwise({redirectTo:"/"}),b.html5Mode(!0)}]).constant("appConstants",{serviceBase:"/",serviceSuffix:".do"}).factory("Auth",function(){var a=!1;return{setLogin:function(b){a=b},isLoggedIn:function(){return a}}}).run(["$rootScope","Auth","$location","utils","$anchorScroll",function(a,b,c,d,e){a.today=new Date,a.Auth=b,a.logout=function(){var a=d.definePostService("logout")();d.handlePromise(a,function(a){b.setLogin(!1),"LOGOUT_SUCCESS"===a.status?c.path("/"):c.path("/error")})},a.$on("$routeChangeStart",function(a,d,f){var g=b.isLoggedIn();if(e(),d.$$route.data)switch(d.$$route.data.accessType){case"LOGIN":g||(a.preventDefault(),c.path("/login"));break;case"NOT_LOGIN":g&&(a.preventDefault(),c.path("/"))}})}]),angular.module("clientApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("clientApp").controller("LoginCtrl",["$scope","utils","$location","Auth",function(a,b,c,d){a.controls={loginError:!1,message:""},a.doLogin=function(){if(console.log(a),a.controls.loginError=!1,a.loginform.$invalid)return void angular.forEach(a.loginform.$error,function(a){angular.forEach(a,function(a){a.$setTouched(),a.$setDirty()})});var e={email:a.loginform.email.$viewValue,password:a.loginform.password.$viewValue},f=b.definePostService("login")(e);b.handlePromise(f,function(b){console.log(b),"LOGIN_SUCCESS"==b.status?(d.setLogin(!0),c.path("/")):"INVALID_CREDS"==b.status&&(a.controls.loginError=!0,a.controls.message="Invalid Credentials")})}}]),angular.module("clientApp").controller("RegisterCtrl",["$scope","utils","$location","Auth",function(a,b,c,d){a.controls={registerError:!1,message:""},a.doRegister=function(){if(a.controls.registerError=!1,a.registerform.confirmPassword.$setValidity("match",a.registerform.password.$viewValue==a.registerform.confirmPassword.$viewValue),a.registerform.$invalid)return void angular.forEach(a.registerform.$error,function(a){angular.forEach(a,function(a){a.$setTouched(),a.$setDirty()})});var e={email:a.registerform.email.$viewValue,password:a.registerform.password.$viewValue},f=b.definePostService("register")(e);b.handlePromise(f,function(b){console.log(b),"SIGNUP_SUCCESS"==b.status?(d.setLogin(!0),c.path("/")):"SIGNUP_INVALID"==b.status&&(a.controls.registerError=!0,a.controls.message="User exists")})}}]),angular.module("clientApp").controller("ProfileCtrl",["$scope","utils","$location","Auth",function(a,b,c,d){}]),angular.module("clientApp").controller("ProductsCtrl",["$scope","utils","$location",function(a,b,c){var d=b.definePostService("products")();b.handlePromise(d,function(a){console.log(a)})}]),angular.module("clientApp").service("utils",["$http","appConstants","$location",function(a,b,c){this.defineGetService=function(c){return function(){return a({method:"GET",url:b.serviceBase+c+b.serviceSuffix})}},this.definePostService=function(c){return function(d){return void 0===d&&(d={}),a({method:"POST",url:b.serviceBase+c+b.serviceSuffix,data:d,headers:{"Content-type":"application/json"}})}},this.handlePromise=function(a,b){a.then(function(a){200==a.status&&b(a.data)})}}]),angular.module("clientApp").run(["$templateCache",function(a){a.put("views/error.html","<h1>Oops! something went wrong</h1>"),a.put("views/login.html",'<form name="loginform" ng-submit="doLogin()"> <div class="title-section"> <h1><span>Login Here</span></h1> </div> <div class="row"> <div class="form-group col-sm-6"> <label for="exampleInputEmail1">Email address</label> <input type="email" name="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email" ng-model="data.email" ng-pattern="/[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,3}$/" ng-required="true"> <small id="emailHelp" class="form-text text-muted">We\'ll never share your email with anyone else.</small> </div> </div> <div class="row"> <div class="form-group col-sm-6"> <label for="exampleInputPassword1">Password</label> <input type="password" name="password" class="form-control" id="exampleInputPassword1" placeholder="Password" ng-model="data.password" ng-minlength="6" maxlength="25" ng-required="true"> </div> </div> <div class="row"> <div class="form-group col-sm-6"> <button type="submit" class="btn btn-primary">Submit</button> </div> </div> <p ng-if="controls.loginError" ng-bind-html="controls.message"></p> </form>'),a.put("views/main.html",'<div class="jumbotron"> <h1>Welome to Online Product Portal!</h1> <p class="lead"> Review catalog </p> <p><a class="btn btn-lg btn-success" ng-href="/products">Products</a></p> </div>'),a.put("views/products.html","<h1>Product List</h1>"),a.put("views/profile.html",'<form name="registerform" ng-submit="updateProfile()"> <div class="title-section"> <h1><span>Profile</span></h1> </div> <div class="row"> <div class="form-group col-sm-6"> <label for="exampleInputEmail1">Email address</label> <input type="email" name="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email" ng-model="data.email" ng-pattern="/[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,3}$/" ng-required="true"> </div> </div> <div class="row"> <div class="form-group col-sm-6"> <label for="exampleInputPassword1">Old Password</label> <input type="password" name="password" class="form-control" id="exampleInputPassword1" placeholder="Password" ng-model="data.password" ng-minlength="6" maxlength="25" ng-required="true"> </div> </div> <div class="row"> <div class="form-group col-sm-6"> <label for="InputPassword1">New Password</label> <input type="password" name="newPassword" class="form-control" id="InputPassword1" placeholder="Password" ng-model="data.password" ng-minlength="6" maxlength="25" ng-required="true"> </div> </div> <div class="row"> <div class="form-group col-sm-6"> <label for="InputPassword2">Confirm New Password</label> <input type="password" name="confirmNewPassword" class="form-control" id="InputPassword2" placeholder="Confirm Password" ng-model="data.Confirm" ng-minlength="6" maxlength="25" ng-required="true"> </div> </div> <div class="row"> <div class="form-group col-sm-6"> <button type="submit" class="btn btn-primary">Submit</button> </div> </div> </form>'),a.put("views/register.html",'<form name="registerform" ng-submit="doRegister()"> <div class="title-section"> <h1><span>Register Here</span></h1> </div> <div class="row"> <div class="form-group col-sm-6"> <label for="exampleInputEmail1">Email address</label> <input type="email" name="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email" ng-model="data.email" ng-pattern="/[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,3}$/" ng-required="true"> <small id="emailHelp" class="form-text text-muted">We\'ll never share your email with anyone else.</small> </div> </div> <div class="row"> <div class="form-group col-sm-6"> <label for="exampleInputPassword1">Password</label> <input type="password" name="password" class="form-control" id="exampleInputPassword1" placeholder="Password" ng-model="data.password" ng-minlength="6" maxlength="25" ng-required="true"> </div> </div> <div class="row"> <div class="form-group col-sm-6"> <label for="exampleInputPassword2">Confirm Password</label> <input type="password" name="confirmPassword" class="form-control" id="exampleInputPassword2" placeholder="Confirm Password" ng-model="data.Confirm" ng-minlength="6" maxlength="25" ng-required="true"> </div> </div> <div class="row"> <div class="form-group col-sm-6"> <button type="submit" class="btn btn-primary">Submit</button> </div> </div> <p ng-if="controls.registerError" ng-bind-html="controls.message"></p> </form>')}]);